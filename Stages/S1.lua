Set1={
	name = "Vale of the Surreal",
	nR = 4,
	rounds = {			
		--first round
		[1] = {
			nWave =3,
			Waves = {
				[1] = {
					nMOB = 2,
					Mobs = {
						[1] = {posx = 173122, posy = 51715, posz = 175943, texture = "MAHelper/Icons/Signal.dds",  X =0.4975206553936 , Y=0.60991734266281, c = 1,}, 
						[2] = {posx = 175427, posy = 51715, posz=172039, texture = "MAHelper/Icons/Signal.dds",  X =0.53553718328476, Y=0.54710745811462, c = 1,},
					},
				},
				[2] = {
					nMOB = 2,
					Mobs = {
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/Signal2.dds",  X =0.4975206553936 , Y=0.60991734266281, c = 1,}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/Signal2.dds",  X =0.53553718328476, Y=0.54710745811462,  c = 1,},
					},
				},
				[3] = {
					nMOB = 3,
					Mobs = {
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/Signal3.dds",  X =0.4975206553936 , Y=0.60991734266281, c = 1,}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/Signal3.dds",  X =0.53553718328476, Y=0.54710745811462, c = 1,},
						[3] = {posx=172634, posy=51701, posz=172502, texture = "MAHelper/Icons/BossRMael.dds", X =0.48760330677032 ,  Y=0.55371898412704,  c = 2,},
					},
				},
			},
		},
		--second round
		[2] = {
		
			nWave =3,
			Waves = {
				[1] = {
					nMOB = 2,
					Mobs = {
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/Signal.dds",  X =0.4975206553936 , Y=0.60991734266281, c = 1,}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/Signal.dds",  X =0.53553718328476, Y=0.54710745811462, c = 1,},
					},
				},
				[2] = {
					nMOB = 3,
					Mobs = {
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/Signal2.dds",  X =0.4975206553936 , Y=0.60991734266281, c = 1}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/Signal2.dds",  X =0.53553718328476, Y=0.54710745811462, c = 1},
						[3] = {posx=172634, posy=51701, posz=172502, texture = "MAHelper/Icons/Signal2.dds", X =0.48760330677032  , Y=0.55371898412704, c = 1},
					},
				},
				[3] = {
					nMOB = 2,
					Mobs = {
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/BossRMael.dds", X =0.4975206553936 , Y=0.60991734266281, c = 2}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/Signal3.dds", X =0.53553718328476, Y=0.54710745811462, c = 1},
					},
				},
			},
		},	
		--third round
		[3] = {
		
			nWave =3,
			Waves = {
				[1] = {
					nMOB = 3,
					Mobs = {						
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/Signal.dds", X =0.4975206553936 , Y=0.60991734266281, c = 1,}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/Signal.dds",  X =0.53553718328476, Y=0.54710745811462, c = 1,},
						[3] = {posx=176066, posy=51701, posz=175366, texture = "MAHelper/Icons/Signal.dds", X=0.54545456171036 ,Y=0.60165292024612, c = 1,},
					},
				},
				[2] = {
					nMOB = 3,
					Mobs = {
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/Signal2.dds",  X =0.4975206553936 , Y=0.60991734266281,c = 1,}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/Signal2.dds",  X =0.53553718328476, Y=0.54710745811462,c = 1,},
						[3] = {posx=176066, posy=51701, posz=175366, texture = "MAHelper/Icons/Signal2.dds",  X=0.54545456171036 ,Y=0.60165292024612,c = 1,},
					},
				},
				[3] = {
					nMOB = 3,
					Mobs = {
						[1] = {posx = 173122, posy = 51705, posz = 175943, texture = "MAHelper/Icons/Signal2.dds",  X =0.4975206553936 , Y=0.60991734266281,c = 1,}, 
						[2] = {posx = 175427, posy = 51705, posz=172039, texture = "MAHelper/Icons/BossRMael.dds",  X =0.53553718328476, Y=0.54710745811462, c = 2,},
						[3] = {posx=176066, posy=51701, posz=175366, texture = "MAHelper/Icons/Signal2.dds", X=0.54545456171036 ,Y=0.60165292024612, c = 1,},
					},
				},
			},
		},
		--Boss	
		[4] = {
			nWave = 1,
			Waves = {
				[1] = {
					nMOB = 1,
					Mobs = {
						[1] = {
							posx=173301, posy = 51705, posz=175273, texture = "MAHelper/Icons/BossMael.dds", X=0.50247931480408 ,Y=0.60000002384186, c = 3}
					},
				},
			},
		},
	},
}

CurrWeave = 1
NumK = 0
local CS = 1
token = true
function Set1.RegEventsLoader()
	CS = 1
	MAHelper.ListAddPosition(1,1)
	EVENT_MANAGER:RegisterForEvent(Set1.name .. "PlayerDeath", EVENT_UNIT_DEATH_STATE_CHANGED, Set1.OnPlayerDeath)
	EVENT_MANAGER:RegisterForEvent(Set1.name .."Announcement", EVENT_DISPLAY_ANNOUNCEMENT, Set1.OnTitleAnnounced)
	EVENT_MANAGER:RegisterForEvent(Set1.name .."kill", EVENT_COMBAT_EVENT, Set1.OnUnitKilled)
	EVENT_MANAGER:AddFilterForEvent(Set1.name .."kill", EVENT_COMBAT_EVENT, REGISTER_FILTER_COMBAT_RESULT, ACTION_RESULT_DIED_XP)
end
function Set1.RegUnloadEvents()
	CS = 1
	EVENT_MANAGER:UnregisterForEvent(Set1.name .. "PlayerDeath", EVENT_COMBAT_EVENT, Set1.OnPlayerDeath)
	EVENT_MANAGER:UnregisterForEvent(Set1.name .."Announcement", EVENT_DISPLAY_ANNOUNCEMENT, Set1.OnTitleAnnounced)
	EVENT_MANAGER:UnregisterForEvent(Set1.name .."kill", EVENT_COMBAT_EVENT, Set1.OnUnitKilled)
end

function  Set1.OnTitleAnnounced(eventcode, title)
	NumK = 0 
	CurrWeave = 1
	CS = MAHelper.OnTitleReturnRound(title)
	if CS >= 1 then
		MAHelper.RemoveIcons()
		MAHelper.ListAddPosition(CS , 1)
	end
end

function  Set1.OnPlayerDeath( eventCode,  unitTag,  isDead)
	if isDead and unitTag == "player" then
		CurrWeave = 1
		MAHelper.RemoveIcons()
		MAHelper.ListAddPosition(CS , 1)
	end
end	

function Set1.OnUnitKilled(eventCode,   result,  isError,  abilityName,  abilityGraphic,   abilityActionSlotType,  sourceName,   sourceType,   targetName,   targetType,  hitValue,   powerType,   damageType,  log,  sourceUnitId,  targetUnitId,  abilityId,  overflow)
	NumK = NumK + 1
	if NumK >= Set1.rounds[CS].Waves[CurrWeave].nMOB then
		token = false 
		zo_callLater(function() token = true end, 4000)
		MAHelper.RemoveIcons()
		CurrWeave = CurrWeave +1
		if CurrWeave <= Set1.rounds[CS].nWave then
			NumK = 0			
			MAHelper.ListAddPosition(CS, CurrWeave)		
		else
			CurrWeave = 1
			NumK=0
			CS = CS +1
			MAHelper.RemoveIcons()
			if CS <= Set1.nR then 			
				MAHelper.ListAddPosition(CS, 1)	
			end
		end
	end
end
